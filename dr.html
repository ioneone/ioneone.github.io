<!DOCTYPE html>
<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-102111467-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-102111467-2');
    </script>
    <meta charset="utf-8">
    <link rel="stylesheet" href="styles.css">
    <title>Junhong Wang | Digit Recognizer</title>
  </head>
  <body>
    <div>
      <div>
        <h1><a href="index.html">Junhong Wang</a></h1>
      </div>
      <div>
        <h2>Digit Recognizer</h2>
        <canvas id="canvas" width=140 height=140></canvas>
        <p>True Label: <span id="true_lbl"></span></p>
        <p>Decision Tree Prediction (accuracy 87.21%): <span id="dt_pred"></span></p>
      </div>
    </div>

    <script type="text/javascript" src="data.json"></script>
    <script type="text/javascript">
      var canvas = document.querySelector('canvas');
      var context = canvas.getContext("2d");

      var imageSize = 28;
      var scale = 5;
      var imgData = context.createImageData(imageSize*scale, imageSize*scale);

      var x_test = JSON.parse(x_test);
      var y_pred = JSON.parse(y_pred);
      var y_test = JSON.parse(y_test);
      console.log(x_test.length);

      function showRandomMNIST() {
        var index = Math.floor(Math.random() * x_test.length)
        var data = x_test[index];
      
        var i = 0;
        var j = 0;
        var col = 0;
        var row = 0;
        var ptr = 0;
        for (row = 0; row < imageSize; row++) {
          for (i = 0; i < scale; i++) {
            for (col = 0; col < imageSize; col++) {
              for (j = 0; j < scale; j++) {
                imgData.data[ptr] = data[col + row * imageSize] * 255;     // R
                imgData.data[ptr + 1] = data[col + row * imageSize] * 255; // G
                imgData.data[ptr + 2] = data[col + row * imageSize] * 255; // B
                imgData.data[ptr + 3] = 255;                               // A
                ptr += 4;
              } 
            }
          }
        }
        
        context.putImageData(imgData, 0, 0);

        document.getElementById("true_lbl").innerHTML = y_test[index];
        document.getElementById("dt_pred").innerHTML = y_pred[index];
        if (y_pred[index] == y_test[index]) {
          document.getElementById("dt_pred").innerHTML += ' &#x2713;'
        } else {
          document.getElementById("dt_pred").innerHTML += ' &#x2717;'
        }
        
      }

      showRandomMNIST();
      setInterval(showRandomMNIST, 1000); // 1000 = 1s
      

      
    </script>

  </body>

</html>
