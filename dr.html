<!DOCTYPE html>
<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-102111467-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-102111467-2');
    </script>
    <meta charset="utf-8">
    <link rel="stylesheet" href="styles.css">
    <title>Junhong Wang | Digit Recognizer</title>
  </head>
  <body>
    <div>
      <div>
        <h1><a href="index.html">Junhong Wang</a></h1>
      </div>
      <div>
        <h2>Digit Recognizer</h2>
        <p><a href="https://github.com/ioneone/ML/tree/master/Projects/DigitRecognizer/src">Github</a></p>
        <canvas id="canvas" width=140 height=140></canvas>
        <p>True Label: <span id="true_label"></span></p>
        <p>Decision Tree Prediction (accuracy 87.21%): <span id="decision_tree_pred"></span></p>
        <p>K Nearest Neighbors Prediction: Takes too long to predict</p>
        <p>Perceptron (accuracy 89.23%): <span id="perceptron_pred"></span></p>
      </div>
      <div>
        <h3>Dev Log</h3>
        <ul>
          <li><a href="https://medium.com/@ionejunhong/my-machine-learning-diary-day-100-a469bf770da4">MLD Day 100</a>: Decision Tree</li>
          <li><a href="https://medium.com/@ionejunhong/my-machine-learning-diary-day-101-56f91f4bc57a">MLD Day 101</a>: Display Project on browser</li>
          <li><a href="https://medium.com/@ionejunhong/my-machine-learning-diary-day-102-a38b3fa6ed17">MLD Day 102</a>: KNN, Perceptron</li>
        </ul>
      </div>
    </div>

    <script type="text/javascript" src="data.json"></script>
    <script type="text/javascript">
      var canvas = document.querySelector('canvas');
      var context = canvas.getContext("2d");

      var imageSize = 28;
      var scale = 5;
      var imgData = context.createImageData(imageSize*scale, imageSize*scale);

      var x_test = JSON.parse(x_test);
      var y_test = JSON.parse(y_test);

      var y_decision_tree_pred = JSON.parse(y_decision_tree_pred);
      var y_perceptron_pred = JSON.parse(y_perceptron_pred);

      function showRandomMNIST() {
        var index = Math.floor(Math.random() * x_test.length)
        var data = x_test[index];
      
        var i = 0;
        var j = 0;
        var col = 0;
        var row = 0;
        var ptr = 0;
        for (row = 0; row < imageSize; row++) {
          for (i = 0; i < scale; i++) {
            for (col = 0; col < imageSize; col++) {
              for (j = 0; j < scale; j++) {
                imgData.data[ptr] = data[col + row * imageSize] * 255;     // R
                imgData.data[ptr + 1] = data[col + row * imageSize] * 255; // G
                imgData.data[ptr + 2] = data[col + row * imageSize] * 255; // B
                imgData.data[ptr + 3] = 255;                               // A
                ptr += 4;
              } 
            }
          }
        }
        
        context.putImageData(imgData, 0, 0);

        document.getElementById("true_label").innerHTML = y_test[index];

        document.getElementById("decision_tree_pred").innerHTML = y_decision_tree_pred[index];
        if (y_decision_tree_pred[index] == y_test[index]) {
          document.getElementById("decision_tree_pred").innerHTML += ' &#x2713;'
        } else {
          document.getElementById("decision_tree_pred").innerHTML += ' &#x2717;'
        }

        document.getElementById("perceptron_pred").innerHTML = y_perceptron_pred[index];
        if (y_perceptron_pred[index] == y_test[index]) {
          document.getElementById("perceptron_pred").innerHTML += ' &#x2713;'
        } else {
          document.getElementById("perceptron_pred").innerHTML += ' &#x2717;'
        }
        
      }

      showRandomMNIST();
      setInterval(showRandomMNIST, 1000); // 1000 = 1s
      

      
    </script>

  </body>

</html>
